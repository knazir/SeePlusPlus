name: code-runner
type: Scheduled Job

# Run configuration
on:
  schedule: "@on-demand"

cpu: 1024
memory: 2048
platform: linux/x86_64

# Network configuration
network:
  vpc:
    placement: 'private'

# Container configuration
image:
  build:
    dockerfile: ./code-runner/Dockerfile
    context: ./code-runner

# Environment configuration
environments:
  test:
    cpu: 2048
    memory: 4096
  production:
    cpu: 2048
    memory: 4096

# Custom IAM policies
taskRole:
  policies:
    - name: S3AccessPolicy
      document:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - s3:GetObject
            Resource:
              - 'arn:aws:s3:::seepp-*/code/*'
          - Effect: Allow
            Action:
              - s3:PutObject
            Resource:
              - 'arn:aws:s3:::seepp-*/trace/*'

# Timeout configuration
timeout: 5m